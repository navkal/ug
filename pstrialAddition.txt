How to add Panel Spy Trial website to your apache2 server running on Linux:
(These instructions assume that you have installed Anaconda, apache2, and PHP, and set up the SMTP relay.)


Choose a port that is not already in use on your apache2 server.  In the following example, I use 8088.


0.  If you don't already have it, install Python 'natsort'

conda install natsort


1.  If you are replacing an existing deployment, clean it up

sudo rm -rf /opt/ps


2.	Unzip ps_2018_xx_xx.zip in /opt directory, creating the Panel Spy Trial codebase at /opt/ps

unzip ps_2018_xx_xx.zip -d /opt


3.	Create link from document root to ps codebase

sudo ln -s /opt/ps /var/www/ps


4. Get or update the 'common' code

   * If you don't have it:

cd /opt
git clone https://github.com/navkal/common.git
( is this needed? ) --> sudo ln -s /opt/common /var/www/common

   * If you already have it:

cd /opt/common/
git pull origin master


5. Change ownership of directories and databases

sudo chown www-data:www-data /opt/ps/database/*
sudo chown www-data:www-data /opt/ps/database/*/database.sqlite
sudo chown www-data:www-data /opt/ps/database/*/*/images
sudo chown www-data:www-data /opt/ps/database/*/*/images/*


6.	Create virtual host definition file /etc/apache2/sites-available/ps.conf

    (Note: PYTHON path might differ from example shown below.)

<VirtualHost *:8088>
        ServerAdmin webmaster@localhost
        DocumentRoot /var/www/ps
        ErrorLog ${APACHE_LOG_DIR}/error.log
        CustomLog ${APACHE_LOG_DIR}/access.log combined
        SetEnv PYTHON "/home/ea/anaconda3/bin/python"
        SetEnv PANEL_SPY_ENTERPRISE "andover"
</VirtualHost>


7.	Add to ports file /etc/apache2/ports.conf

Listen 8088


8.	Enable website

sudo a2ensite ps.conf


9.  Enable mod_rewrite

sudo a2enmod rewrite


10.	Reload and restart server

sudo service apache2 reload
sudo service apache2 restart
